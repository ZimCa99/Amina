<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Koverta za Aminu ‚ù§Ô∏è</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
        background: #020412;
      }
      #container {
        width: 100%;
        height: 100%;
      }
      #message {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
        color: #ff4d6d;
        text-align: center;
        background: rgba(0, 0, 0, 0.6);
        padding: 20px;
        border-radius: 20px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <div id="message">
      Amina‚Ä¶ ti si moja noƒá, moje zvezde i moj mir. üíñ<br />Biram te, danas i
      uvek.
    </div>

    <script src="https://cdn.jsdelivr.net/npm/three@0.146.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r146/examples/js/controls/OrbitControls.js"></script>

    <script>
      // Scene, Camera, Renderer
      let scene = new THREE.Scene();
      let camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      let renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.getElementById("container").appendChild(renderer.domElement);

      // Controls
      let controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enablePan = false;
      controls.enableZoom = false;
      controls.enableRotate = true;
      camera.position.set(0, 1, 3);
      controls.update();

      // Letter / Envelope
      let loader = new THREE.TextureLoader();
      let letterTexture = loader.load("https://i.imgur.com/1jpNs3Z.png");
      let letterGeo = new THREE.PlaneGeometry(0.7, 0.5);
      let letterMat = new THREE.MeshBasicMaterial({
        map: letterTexture,
        transparent: true,
      });
      let letter = new THREE.Mesh(letterGeo, letterMat);
      letter.position.set(0, 0, 0);
      scene.add(letter);

      // Floating Hearts
      let hearts = [];
      function createHeart() {
        let heartGeo = new THREE.SphereGeometry(0.1, 8, 8);
        let heartMat = new THREE.MeshBasicMaterial({ color: 0xff4d6d });
        let h = new THREE.Mesh(heartGeo, heartMat);
        h.position.set(
          (Math.random() - 0.5) * 2,
          Math.random() * 2,
          (Math.random() - 0.5) * 2
        );
        scene.add(h);
        hearts.push(h);
        setTimeout(() => {
          scene.remove(h);
          hearts.splice(hearts.indexOf(h), 1);
        }, 5000);
      }
      setInterval(createHeart, 500);

      // Stars
      let stars = [];
      for (let i = 0; i < 100; i++) {
        let sGeo = new THREE.SphereGeometry(0.02, 6, 6);
        let sMat = new THREE.MeshBasicMaterial({
          color: 0xffffff,
          transparent: true,
        });
        let s = new THREE.Mesh(sGeo, sMat);
        s.position.set(
          (Math.random() - 0.5) * 10,
          Math.random() * 5,
          (Math.random() - 0.5) * 10
        );
        scene.add(s);
        stars.push(s);
      }

      // Ambient Light
      scene.add(new THREE.AmbientLight(0xffffff, 0.3));

      // Raycaster for clicking letter
      let raycaster = new THREE.Raycaster();
      let mouse = new THREE.Vector2();
      function onClick(event) {
        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        raycaster.setFromCamera(mouse, camera);
        let intersects = raycaster.intersectObjects([letter]);
        if (intersects.length > 0) {
          document.getElementById("message").style.display = "block";
          for (let i = 0; i < 20; i++) createHeart();
        }
      }
      window.addEventListener("click", onClick, false);

      // Music
      let music = new Audio(
        "https://cdn.pixabay.com/audio/2022/03/15/audio_4b8b8f2e6b.mp3"
      );
      music.loop = true;
      music.volume = 0.4;
      window.addEventListener(
        "click",
        () => {
          if (music.paused) {
            music.play();
          }
        },
        { once: true }
      );

      // Animate
      function animate() {
        requestAnimationFrame(animate);
        controls.update();

        // Animate hearts
        hearts.forEach((h) => {
          h.position.y += 0.01;
          h.rotation.x += 0.05;
          h.rotation.y += 0.03;
        });

        // Animate letter (pulsing)
        letter.position.y = 0 + 0.05 * Math.sin(Date.now() * 0.005);

        // Animate stars (blinking)
        stars.forEach((s) => {
          s.material.opacity =
            0.5 + 0.5 * Math.sin(Date.now() * 0.005 + s.position.x);
        });

        renderer.render(scene, camera);
      }
      animate();

      window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    </script>
  </body>
</html>
